var player,balls=[],playerElement,ballElements=[],animationID,ticks=0,seconds=0;function ballsCollide(a,b,c,d){var e=Math.abs(b.xPos+d/2-(a.xPos+c/2));a=Math.abs(b.yPos+d/2-(a.yPos+c/2));return Math.sqrt(e*e+a*a)<c/2+d/2}function moveEverything(){player.move(600,500);for(var a=0;a<balls.length;a++){var b=balls[a],c=ballElements[a];b.move(600,500);c.css("left",b.xPos);c.css("top",b.yPos)}playerElement.css("left",player.xPos);playerElement.css("top",player.yPos)}
function collision(){for(var a=!1,b=0;b<balls.length;b++)if(ballsCollide(balls[b],player,50,30)){a=!0;break}return a}
function startGame(){console.log("Starting a game.");animationID=setInterval(function(){moveEverything();collision()&&(clearInterval(animationID),$("#timePlayed").append("<strong>Time:</strong> "+seconds+"."+1E3*ticks+" s"),$("#totalScore").append("<strong>Score:</strong> "+(balls.length*seconds+ticks).toString()),$("body").append('<div id="startGame">Restart</div>'),$("#startGame").unbind().click(function(){for(var a=0;a<ballElements.length;a++)ballElements[a].remove();player.xPos=0;player.yPos=
0;seconds=ticks=player.vel=0;balls=[];ballElements=[];$("#timePlayed").text("");$("#totalScore").text("");startGame();$("#startGame").remove()}));60===++ticks&&(ticks=0,0===++seconds%10?addBall():7<seconds%10?$("#originBox").css("background-color","red"):$("#originBox").css("background-color","white"))},17);addBall()}function addBall(){var a=new Ball(300,250),b=$('<div class="ball"></div>');balls.push(a);ballElements.push(b);$("#space").append(b)}
$(document).ready(function(){player=new Player(0,0);playerElement=$("#player");$("#startGame").unbind().click(function(){startGame();$("#startGame").remove()})});$(document).on("keydown",function(a){player.changeDirection(a.keyCode)});
